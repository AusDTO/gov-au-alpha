---
layout: default
title:  "Give feedback"
include_on_homepage: true
---
{% include breadcrumbs.html %}
<div class="container {{ page.section | downcase }}">

  <div class="row">
    <div class="col-sm-12 section-nav">
      <span class="fa fa-angle-left"></span>&nbsp;<a href="#" id="globalBackBtn1" class="back" onclick="history.go(-1);" >Back</a>
      </div>
    </div>
    <div class="row">
        <div class="col-sm-12 col-lg-10">
            <h1>Give feedback</h1>

            <form id="feedbackForm">
              <p>Use the form below to tell us what you think and
                suggest how we can improve.<br/></p>
                <div class="error-message hide" id="feedback-error">
                </div>
                <fieldset id="site_or_page">
                    <legend id="feedback-question h2">Just checking - is the feedback for the whole
                      GOV.AU prototype or the page you just saw?</legend>
                    <input id="whole-site" name="site_or_page" type="radio" value="The whole site"/>
                    <label for="whole-site">Whole GOV.AU </label>
                    <input id="this-page" name="site_or_page" type="radio" value="This specific page"/>
                    <label for="this-page">This specific page</label>

                </fieldset>
              <fieldset id="feeling">
                <legend id="feedback-question">Overall, how do you feel about the page?</legend>
                <input id="very-satisfied" name="feeling" type="radio" value="Very Satisfied"/>
                <label for="very-satisfied">Very Satisfied</label>
                <input id="satisfied" name="feeling" type="radio" value="Satisfied"/>
                <label for="satisfied">Satisfied</label>
                <input id="neutral" name="feeling" type="radio" value="Neither satisfied nor dissatisfied"/>
                <label for="neutral">Neither satisfied nor dissatisfied</label>
                <input id="dissatisfied" name="feeling" type="radio" value="Dissatisfied"/>
                <label for="dissatisfied">Dissatisfied</label>
                <input id="very-dissatisfied" name="feeling" type="radio" value="Very Dissatisfied"/>
                <label for="very-dissatisfied">Very Dissatisfied</label>
              </fieldset>

                <label for="feedback"><strong>Can you provide more details?</strong></label>
              <p>The feedback you give helps the Digital Transformation Office to improve on all the work we’ve done so far, to bring you the GOV.AU Prototype. It’s up to you, to decide how much feedback you give and you can be anonymous or use a pseudonym.<br/></p>
                <textarea id="feedback" name="feedback" rows="3" maxlength="1200"></textarea><br/>
              <p>(Limit is 1200 characters)</p>
                <input id="referrer" name="referrer" type="hidden" value=""/>
                <input id="fp" name="fp" type="hidden" value=""/>
                <input id="fp_detail" name="fp_detail" type="hidden" value=""/>

                <input name="send" id="send" type="submit" value="Send feedback"/>
            </form>
            {% js 'vendor/fingerprint2.min.js' %}
            <script>
                // Variable to hold request
                var request;
                var fingerprint;
                var fingerprint_components_json;
                function getFileName(url) {
                    // http://befused.com/javascript/get-filename-url
                    //this removes the anchor at the end, if there is one
                    url = url.substring(0, (url.indexOf("#") == -1) ? url.length : url.indexOf("#"));
                    //this removes the query after the file name, if there is one
                    url = url.substring(0, (url.indexOf("?") == -1) ? url.length : url.indexOf("?"));
                    //this removes everything before the last slash in the path
                    url = url.substring(url.lastIndexOf("/") + 1, url.length);
                    //return
                    return url;
                }
                $(function () {

                    new Fingerprint2().get(function (result, components) {
                        fingerprint = result;
                        var components_flat = {};
                        for (x in components) {
                            if (components[x]['key'] != 'canvas' && components[x]['key'] != 'js_fonts' && components[x]['key'] != 'webgl') {
                                components_flat[components[x]['key']] = components[x]['value'];
                            }
                        }
                        fingerprint_components_json = JSON.stringify(components_flat);

                });
                // Bind to the submit event of our form
                $("#feedbackForm").submit(function (event) {

                    // Abort any pending request
                    if (request) {
                        request.abort();
                    }
                    // setup some local variables
                    var $form = $(this);
                    if ($("#feedback").val() === ''
                        && $( "input:radio[name=site_or_page]:checked" ).val() == undefined
                        && $( "input:radio[name=feeling]:checked" ).val() == undefined) {
                      $("#feedback").addClass('error');
                      $("#feeling").addClass('error');
                        $("#site_or_page").addClass('error');
                        $("#feedback-error").html("<p>Please enter some feedback</p>");

                        $("#feedback-error").removeClass('hide');

                    } else {
                        $("#site_or_page").removeClass('error');
                      $("#feedback").removeClass('error');

                      $("#feeling").removeClass('error');

                        $("#feedback-error").addClass('hide');
                        $("#feedback-error").html("");
                        // Let's select and cache all the fields
                        var $inputs = $form.find("input, select, button, textarea");

                        $('#referrer').val(document.referrer);
                        $('#fp').val(fingerprint);
                        $('#fp_detail').val(fingerprint_components_json);

                        // Serialize the data in the form
                        var serializedData = $form.serialize();

                        // Let's disable the inputs for the duration of the Ajax request.
                        // Note: we disable elements AFTER the form data has been serialized.
                        // Disabled form elements will not be serialized.
                        $inputs.prop("disabled", true);


                        // Fire off the request to /form.php
                        request = $.ajax({
                            url: "https://script.google.com/macros/s/AKfycbyGdJVlsp9ZJA0ONAfZSei2_-TslKbM8YfG8vPYmB72SEVX2xRk/exec",
                            type: "post",
                            data: serializedData,
                            beforeSend: function () {

                                $('#send').val("Sending...");

                            }
                        });

                        // Callback handler that will be called on success
                        request.done(function (response, textStatus, jqXHR) {
                            // Log a message to the console;
                          $('#feedbackForm').html('<br/><p>Thanks for your feedback <br/> <p><a href="'+document.referrer+'" class="button">Return to the prototype?</a></p>');
                        });

                        // Callback handler that will be called on failure
                        request.fail(function (jqXHR, textStatus, errorThrown) {
                            // Log the error to the console
                            console.error(
                                    "The following error occurred: " +
                                    textStatus, errorThrown
                            );

                            $('#send').val("Try again...");
                        });

                        // Callback handler that will be called regardless
                        // if the request failed or succeeded
                        request.always(function () {
                            // Reenable the inputs
                            $inputs.prop("disabled", false);
                        });
                    }
                    // Prevent default posting of form
                    event.preventDefault();
                });
              });
            </script>
        </div>
    </div>
</div>
